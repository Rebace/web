const elementEmail=document.querySelector('.form__email');const elementName=document.querySelector('.form__name');const elementActivity=document.querySelector('.form__activity');const elementAgreement=document.querySelector('.form__checkbox');const formButton=document.querySelector('.form__button');const nameExpression=new RegExp('^[A-Za-zА-Яа-я \-]+$');const emailExpression=new RegExp('^[A-Za-z0-9_\.\-]+@[A-Za-z0-9\-]+\.[A-Za-z]{2,}$');document.addEventListener("DOMContentLoaded",()=>{formButton.addEventListener('click',sendForm)});function validation(){elementName.classList.remove('input_error');elementEmail.classList.remove('input_error');elementActivity.classList.remove('input_error');let isValid=!0;if(!nameExpression.test(elementName.value)){elementName.classList.add('input_error');isValid=!1}if(!emailExpression.test(elementEmail.value)){elementEmail.classList.add('input_error');isValid=!1};if(elementActivity.value==='-'){elementActivity.classList.add('input_error');isValid=!1};return isValid};function sendForm(){if(!validation()){return};const user={email:elementEmail.value,first_name:elementName.value,activity:elementActivity.value,agreement:elementAgreement.checked==1?'on':'off'};fetch('save_survey.php',{method:'POST',body:JSON.stringify(user)}).then(response=>{return response.text()}).then(result=>{if(JSON.parse(result)['status']!=200){console.log(result);popupError()}else{console.log(result);popupOff()}}).catch(error=>console.log(error))};const btn=document.getElementsByClassName('btn');const btnoff=document.getElementsByClassName('btnoff');const form=document.querySelector('.main__questionnaire');const contentForm=document.querySelector('.questionnaire-content');const bgform=document.querySelector('.popup');const error=document.querySelector('.form__error');[].forEach.call(btn,function(el){el.addEventListener('click',()=>{const id=requestAnimationFrame(popupOn);cancelAnimationFrame(id);return requestAnimationFrame(popupOn)})});[].forEach.call(btnoff,function(el){el.addEventListener('click',()=>{const id=requestAnimationFrame(popupOff);cancelAnimationFrame(id);return requestAnimationFrame(popupOff)})});document.onkeydown=logKey;function logKey(e){if(e.code=="Escape"){popupOff()}};function popupOn(){form.classList.add('popup_form-on');bgform.classList.add('popup_bg-on');form.classList.remove('popup_form-off');bgform.classList.remove('popup_bg-off');contentForm.style.display='flex'};function popupOff(){form.classList.add('popup_form-off');bgform.classList.add('popup_bg-off');form.classList.remove('popup_form-on');bgform.classList.remove('popup_bg-on');error.classList.add('form__error-off');error.classList.remove('form__error-on')};function popupError(){contentForm.style.display='none';error.classList.add('form__error-on');error.classList.remove('form__error-off')}